<!DOCTYPE html>
<html>
  <img src="{{ url_for('static', filename='logo.svg') }}" alt="Logo" width="200">
<head>
  <title>Source's Stream Tool</title>
  <style>
    body {
      background-color: #111;
      color: white;
      font-family: sans-serif;
      padding: 20px;
    }

    h1 {
      margin-bottom: 20px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: auto auto auto auto;
      gap: 0px;
      align-items: center;
      margin-bottom: 10px;
    }

    label {
      font-weight: bold;
    }

    input[type="text"] {
      padding: 5px;
      width: 120px;
      background-color: #222;
      border: 1px solid #555;
      color: white;
    }  
  
    input[readonly] {
      padding: 5px;
      width: 60px;
      background-color: #222;
      border: 1px solid #555;
      color: white;
    } 

    input[type="number"] {
      padding: 5px;
      width: 30px;
      background-color: #222;
      border: 1px solid #555;
      color: white;
    }

    .section {
      margin-bottom: 20px;
    }

    button {
      padding: 6px 12px;
      color: white;
      background-color: #009905;
      border: 1px solid rgb(190, 190, 190);
      cursor: pointer;
      font-size: 14px;
    }

    button:hover {
      background-color: #006203;
    }

    .centered-row {
      display: flex;
      justify-content: center;
      margin: 10px 0;
    }

    .red-button {
      background-color: rgb(177, 0, 0);
    }

    .red-button:hover{
      background-color: rgb(109, 0, 0);
    }

  </style>

</head>
<body>
  
  <!-- Round and Best Of -->
  <div class="centered-row">
    <!--body>Round</body-->
    <input type="text" id="round" placeholder="Round" value="{{ data.round }}">
    <input value="Best Of" width="90px" readonly></input>
    <input type="number" id="bestof" min="1" max="9" step="2" value="{{ data.bestof }}">
  </div>

  <br>
  <br>
  
  <!-- Player Names + Scores -->
  <div class="centered-row">
    <!--label>P1 Nametag</label-->
    <input type="text" id="player1_name" placeholder="Player 1" value="{{ data.player1_name }}">
    <!--label>P2 Nametag </label-->
    <input type="text" id="player2_name" placeholder="Player 2" value="{{ data.player2_name }}">
  </div>

  <div class="centered-row">
    <!--label>P1 Score</label-->
    <input type="number" id="player1_score" value="{{ data.player1_score }}">
    <!--label>P2 Score</label-->
    <input type="number" id="player2_score" value="{{ data.player2_score }}">
  </div>

  <!-- Swap Players Button -->
  <div class="centered-row">
    <button onclick="swapPlayers()">⇄</button>
    <button onclick="resetScores()">⟳</button>
  </div>

  <br>
  <br>

  <!-- Commentators -->
  <div class="centered-row">
    <!--label>Comms 1</label-->
    <input type="text" id="commentator1" placeholder="Commentator 1" value="{{ data.commentator1 }}">
    <!--label>Comms 2</label-->
    <input type="text" id="commentator2" placeholder="Commentator 2"value="{{ data.commentator2 }}">
  </div>

  <!-- Swap Commentators Button -->
  <div class="centered-row">
    <button onclick="swapCommentators()">⇄</button>
  </div>

  <br>

  <!-- Update Button -->
  <div class="centered-row">
    <button onclick="saveData()">Update Data</button>
  </div>

  <br>

  <div class="centered-row">
    <button class="red-button" onclick="resetAll()">Reset All</button>
  </div>

  <script>
    function getField(id) {
      return document.getElementById(id).value;
    }

    function setField(id, val) {
      document.getElementById(id).value = val;
    }

    function swapPlayers() {
      const name1 = getField('player1_name');
      const name2 = getField('player2_name');
      const player1_score = getField('player1_score');
      const player2_score = getField('player2_score');
      setField('player1_name', name2);
      setField('player2_name', name1);
      setField('player1_score', player2_score);
      setField('player2_score', player1_score);
    }

    function resetScores() {
      setField('player1_score', 0);
      setField('player2_score', 0);
    }

    function resetAll() {
      setField('player1_name', "Player 1");
      setField('player2_name', "Player 2");
      setField('player1_score', 0);
      setField('player2_score', 0);
      setField('commentator1', "Commentator 1");
      setField('commentator2', "Commentator 2");
      setField('round', "Winners Round 1");
      setField('bestof', 3);
    }

    function swapCommentators() {
      const comm1 = getField('commentator1');
      const comm2 = getField('commentator2');
      setField('commentator1', comm2);
      setField('commentator2', comm1);
    }

    function saveData() {
      const data = {
        player1_name: getField('player1_name'),
        player2_name: getField('player2_name'),
        player1_score: getField('player1_score'),
        player2_score: getField('player2_score'),
        commentator1: getField('commentator1'),
        commentator2: getField('commentator2'),
        round: getField('round'),
        bestof: getField('bestof')
      };

      fetch('/save', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(res => res.json())
      //.then(data => alert(data.message))
      .catch(err => alert("Error saving data"));
    }

    document.addEventListener('keydown', function (e) {
      if (e.key === 'Enter') {
        e.preventDefault();
        saveData();
      }
    });

    window.onload = function () {
      saveData();
    };
  </script>
</body>
</html>
